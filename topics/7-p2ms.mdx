---
title: "P2MS - Pay To Multisig"
date: 2024-01-25T15:32:14Z
lastmod: "2024-07-26"
draft: false
category: Scripts
layout: TopicBanner
order: 7
icon: "FaUsers"
children:
    - 7-1-p2ms-exercise
    - 7-2-p2ms-exercise
---

There are two ways of creating a multisig transaction: Pay-to-multisig, or a Pay-to-script-hash.
currently we will focus on the P2MS or what we refet to as Bare mutisig or Raw multisig

**P2MS** enables multiple parties to agree to a transaction before it can be spent.

This is a script where M out of N possible signers must provide a valid signature for the funds to be spent.

For example, in a 2-of-3 multisig, any two of the three signers can authorize a transaction.

The visualization below allows you to see how this works:

<MultisigAnimation></MultisigAnimation>

<ExpandableAlert
  title="Why is this limited to 3 participants?"
  type="warning"
  expandable={true}
  initialLines={1}
>
As you can see from the visualization above, you have a threshold of 3, which is because standard P2MS is limited to a maximum of 3 public keys.

Exceeding this threshold will make the transaction **NON-STANDARD** and it will not be relayed by nodes.

A workaround for this limitation is to wrap your P2MS in a P2SH, which allows up to 15 public keys (more on that later).

</ExpandableAlert>

<ExpandableAlert
  title="Standardness VS Validity"
  type="important"
  expandable={true}
  initialLines={0}
>

> We need to distinguish the limitations for **validity** and **standardness**.  
> For raw multis every m-of-n combination is **valid** (up to n=20), but **standardness** rules only allow up to n=3.  
> This limitation is enforced when sending (i.e., sending to a 2-of-4 multisig will not be considered standard)."  
> â€” [Pieter Wuille](https://bitcoin.stackexchange.com/questions/23893/what-are-the-limits-of-m-and-n-in-m-of-n-multisig-addresses)

Remember this:

-   **Validity** is determined by the consensus rules (which cannot change without a hard fork).
-   **Standardness** is determined by local relay and mining policies implemented in the reference client, and can change from version to version.

</ExpandableAlert>

### 1. Locking (ScriptPubKey)

To create a raw P2MS script, include the following in the ScriptPubKey:

<CodeSnippet
    code={` 
M
<PubKey1>
<PubKey2>
<PubKeyN>
N
  `}
    language="javascript"
    showLineNumbers={true}
    highlightLines={[2, 6]}
/>

-   **M**: Number of required signatures
-   **Public keys** of all participants
-   **N**: Total number of public keys
-   **OP_CHECKMULTISIG** opcode

**Example**:
Click on **Output 1** of the transaction below to view the scriptPubKey for a 2-of-3 multisig transaction.

<TransactionsDisplay
    rawTx="01000000300d0612ebea41c0a1057ddb7e7f460caff5ebdce0751992fc3340d595d6ef70600200000089463043022059f965d5766ec8ccb48f16dce6a53f69a41334831a46ac539ab1e5b5f1f82ad7021fe1bf0620233de5252a9b6e69631e18d9a7d3c183ec0f79857a68d39619495d01410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342afffffffff0d0612ebea41c0a1057ddb7e7f460caff5ebdce0751992fc3340d595d6ef7060010000008a47304402208c674733c27fb27a7451bb16836b1d2be7bf220df2e5c5a95c28a23fa9646d3c022074206ff4cd1aee2331e7f6ca66de4b5fd37ed4e6d8f0b91f870d6a7603b8d2d70141047a4c5d104002ebc203bef5cab6f13ff57ab624bb5f9f1186beb64c83a396da0d912e11a18ea15a2c784a62fed2bbd8258c3413c18bf4c3f2ba28f3d5565e328bffffffff6721c435c1b5ab80180afa6e4fda2c08c34654676488cc086ef4cc88b77c61ec020000008a4730440220bfdb48a3c543a08f6fb60b7e55daaaba6c38aeaf3f0d1b21f579cf6ac909a6a902201679c52e7da5bfa648dceab18bd9295e57f035c54ed1ba039011c236bdcbbc0d01410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342afffffffff2896f72684c0fb9fbf6eec4efb9e0d031a24d929d105218875b976f2bb5a4198020000008a4730440220353c6f59cb80b6505ea0f524f3c10a4b4cad5c2ec072d778bcd71936363c5a2e0220133b94780a1045daa97db88a463921ff1a3effee1b1c924eecf4683151fb61ff01410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342afffffffff611837cb686946c7f5044128cbf6ca0125505d1291d9024705182d973bcf698e010000008a4730440220b8da93d6b558dbafc401f8c70b112d1c58460aeb831c1440e22a15540f42d6630220fe2e89af071b7134eec3d6b5f200f2023a5115401135f4d160fbceb66393a1b501410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342afffffffff2bd88a7358c41b85d985d11c7dbb8968ce1358fd339481bc2a59c80e7d26769c020000008a47304402202c89a2d3c466257e63eaf03c420644692108f21effa43b805a31a71dc359f99c02200a7a15d722b82dae2e96502fd1efbca5e37bac2ce3da5c23966bdc201ef9751001410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342afffffffff1d5178058cc414cb61758854d11c0d323f359a8f7d01648b76973da79e55028b020000008a47304402200e5187405f5e19d7f25c8f3c4536d83715b1d894c368c79d628daab96e605b4502202b28da764a8934b731cce9398e8bdd8cb335714fb142c58c9e2fc3a2c3e3dc0001410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342afffffffff0c234eafb9aa53e9c0d346ee522c33e4080f56835b93ab35a8ee7551c5eda57c020000008a47304402207f4b4c519410a5edaf6ed431773874e3b0c18a4fe9a5b9e8d7b4e000297c54890220f9a103a9a4493d17db639971dec8b9cb9e412d2d7d8c50cac73b06871aac234401410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342afffffffffbbab9a08ef3704ad4a9c306699522166a865067c64029c9ccd408b1c1c9399fb020000008a4730440220de026c1d61ea91c19d9947e5c8b60c4b43e88ab16747336aa2f2fafc0c75f745022086bf28e69190fd06f45673b3dfe18b6a8377ba49cb6ff4f79f1306ecf426c0b601410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342afffffffff7137838b6e812da278a41c96d71f5ddbe9e484f2efb48ebdb38aa7f1ce7ad51b020000008a473044022068f54b87a549de4d99910acfed984fe8c2e97ff1ee1e20f9361eb94815613576022020f1a000f19ddc2212d1804c59ca0f26d4094f4755a876a160d8bf42e71fbe5901410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342afffffffffb9fd0bdcf959726341a1415a5efb82ad7b5f7c4241de0e64670cd7f836306a5e020000008a47304402203eed67884dc136090b74d9146a6e5bdf8819e9213ce2f6a17683272d9eac8e6f02206b31aff6e686822ebd2d4371a95769f801aa3de8f56e6bf35675cb435ed09ef001410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342afffffffff384c645151190b1d3ea936338451923493546788c0c89dafcdb5c3fa45fceb05010000008a473044022046f133c6a7bae72e9b0d738dc5c6302079c89fcb5b7c4b5ed5b8012f0ac79a380220e13dfdbb8b76889ee07e42a0acb29fc77c140c8c9b8d35a6c1e5d4614eb0229001410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342afffffffffbe2f2532d52984988dd63a78d537830ee9017976a9ebb6e514bb5304df121ba8020000008a4730440220d6c3b70bc247e0613296f223c3d637d376e3d0c02ac688a8c008caa4f23335570220f5509439b6aaa2ffa60183b7ede772cae13dde61f55198fb54dfaf3cb2eda68a01410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342afffffffffee93f96977c9957e03df8f02e2aecb62cfe90c23004b21176dc8bbef3f4f65e9020000008a4730440220a5308eb1f4c2c565e08f0c761e908ab5b788f50a971d2dc68ec804d3a8ba7752022012f38ae5b9f28e327dbbec86becfdb7199e7fd786f023c5e185a28c21703387701410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342afffffffffd76b3be637d98eb88055c6264cf63c252830c59dd96611919a840b595cde534f010000008a4730440220fa449a9f3043bf802996958c9b392b2028370c9b8bd66384cfc2bdc4a89df63f022091372ab5227a97cda9a95536eacdef987068a093da31f7c8d7f2b6b66947a91b01410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342afffffffff74cd4a0e038460d76e4679ffb4e61c990c3ad61ac164264b670e81b443b6f633010000008a4730440220d6d23f07230aec4626aa8a9960013628d5ea4774f96a563eaa147d10849c40f80220d16a6c46e615fc89a6e85a2af1a12379b957c4515ae5e9fd3dbd0fbe8e1777df01410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342afffffffff2eda14e0a2580fe7ec81101fef4fd49e1363f307f78049824756d76790d3a164020000008a473044022086df1ff99cbad765728d2c918e4d91a1dbc903cb646e9693c2d8be5507ecd2670220e849cce17676bd01eb6ec9a61c83825a74e3c4ec6064c682f2ccc02feab5cd0b01410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342afffffffff6ce746d1e902c0e322a4277e600aa33d1078d1f8eeef8d6c0680b2aef0d0d1f6020000008a47304402209e442c16e5dd6a24aee4b5cfe6c07525093e7d5806ee1e424a7aef8b6cf9e1d10220180549e9553985d3bd2babee9d4d00f83979b5d2911bd777367c726c291065af01410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342afffffffff1b54df0eba0992464732125618f83249df03bf5fd506e89eda3de39d6075f9a8020000008a4730440220f22ae34626c3f86fe9a7ceafe26648d5659662014f691bf98955b363a6793fc10220b02a4344348b1019df64dfd25b43fc9c56e71303105673b6f6e81a9c78d4802c01410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342afffffffff03008845004112ce9bdc7148c4f2d9cb4f2bf560142d9cef8ab57d0022910bdb020000008a4730440220aa64ce86467a5d46165b1d05f1f393920e41e73f83958d2ab6b2c5880501a7e902204d8ab56832d0e4fcb8a272785beaced1f7351dad628f93806ddd40f8d0dfb1f601410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342afffffffff5543a94e2c79d19f773ba2ecbde75776096a7c6665efc3ebdcae57610fe97193020000008a473044022020df02435de5d2c3a5f3f2a34d79d986e80ced243558d80c6191d12da486562d022086362424d0d03ed6998b941ff2a0b6110b3c3b0d61573c9d21a9e3945ae366ea01410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342afffffffff3ad9318d7db4ffc0e5d0e35002670eef0ffe4dea19230a6bd6397f112935c463020000008a4730440220ae5a316ffacefe3e3fa89c9e0c45b30e06446626b969e2dde0714819b2b4c0250220b6611dc3a4709c479b9d9f3db1a826eccb39246a5a3f733c271a12e30a2e6fe701410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342afffffffff8c68f483e13e924f44d704d2eb0daee37d185195d37f40dab009db9cb8db72c3020000008a47304402206eed9a73b6cc86783c5d3b0ebe9abeec39135fa6d0001f2fa3e95bdf7009a9ce02202a6874115bee368504b8aca0ce848e80b4ee0faa476235c9c013e44313b7abb801410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342afffffffff4ef98cb9ff64b75996adc5e6b81b004015414eeddd7a57233297607aaf638238010000008a4730440220c44ae666e4eb98dde92af77492bcaac28c3562b62aac228a03df2ff9cee328140220bb889452bcf6427b59aee243ba84b6e9d5e26f86c698ccd3779f88f220f8923901410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342afffffffff22b6b7fad26b300a13f06070129305c3267b671ec7512126803bcff48f6ef701010000008a4730440220260c757b6390e51766d48eb1a5a17ceef4978b0e058a25b6965fb2a90738f7180220b3eecf240a87fa0a5f928c324aca060b751c8e9e7d8adc1f904dba19d03075f101410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342afffffffff8ac365fca7c40804e822283e54b581e3dd811b9bc5c03d2591369daf34e3b1d8010000008a4730440220ce9c8517bff00ee733e02dc8eea9e1ce0d5b49bfb8e8f90785b5d024199c87f70220d5fea8fbf53cb2fcd9ce1fdfbee93be5e75b9434451f147e9cd87c1c860e71f201410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342afffffffff087fb54dccdfacf0b5efe051a30ed1e16dce38df33bac2b73f94d6fadbad6b24020000008a4730440220f632ebb1f1a2a0462c5008aa76a91d04c5fc89ca2ebdf2661ec0f5323a4e3d590220a9f99ce19049ca93c85a96b0d5bef1d13ddc2902aed0930b6cef156f73dd0a7d01410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342afffffffffefb1a3011ccdc508fb87b14542c02b74237edc908266147c2b77e59e74fe41ff020000008a47304402209bb52322901cb16fc1235a80015df75ee22a6f9c52b22a12d3b2d1c22b3fe6d8022067f8b00e8b43e150c2bbe320c2ffabba903325d552eb96c2c204b89fea75317401410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342afffffffffaea9eb2f471c745408c79e4bd158a6052f427a900e78ef31a327fc1e8cbab62b020000008a4730440220f3a94e313bc16c56b5612a0deb2a5f6b2d1bba575f83f4aec0de84641eb694000220c74e722543c8fcbba628ed320ddb7137e60ea849b2252c3b37db0ec893a2267701410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342afffffffffcd70db04ee67cb6342a4ed77bcc93205568a37a3cab867760ac17d447a1240e8020000008a473044022036a6af071a6443819c835abbbaa2c00300461208b45643feef74abf19bdaa1af0220e03f3479b587311fd5ffe0625e68f053c0297a04c4380588b116f0498f3403c001410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342afffffffff19a4c4a528830eb662402dee3f5a5abf96a101eac8947d8e38a19c198804922b020000008a4730440220cb42f4fc5f85655dbf12c5dc3ff80ae06e52c77a84943a18d94b2d662afcdf880220d49de56a484ab1937c6a2a4664fc2ab3c21f2deb221c402f6b6e72989dfd849d01410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342afffffffff124a5405b62fd336e35964037a27f18fd44431e8a8879cbb47a3bc409693e5dd020000008a4730440220636ee102d3374333e7df37b348f99c2077b285bbdf2fde35530180f0c6afddbf02201ffa5a545fbd22eb9f0540eb91de64320dc29d482b55a93bf503671dc1fe640201410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342afffffffff374c682c99510b109a74ad076b905ae478feba075f24fbe2619e25783c549aa0020000008a473044022007a40b4a67d0fcba984d3f0af6853a515b37452520f327d636e05de4a6c2149a0220b053ba5827aa02b4cc4c7e3270b0394c8bda0e893d2ab7cd5776849978f89af401410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342afffffffffeb1c539b1f2f35bf2d68614cfb135d54ee6157f30e392206cd8f70fbd51806cf020000008a47304402209e20dbe1e3184072c0b6a3bd8c9f15f88e37663908424504af527d97efcf38e6022060a2f6163d7d53d4739ff265406a99179394a5615d4875b62b0e372ada1c964701410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342afffffffff2907d8501643508304e3f5af715384d15a5d1bc76fd018e14a1d7a19e3aaae922f0000008a473044022084e55263b38e3907d5525b1f41200d918948afc977eb911b064e76490e7496cd0220642945085a54fc5d3f18d7b7071b9a93e07bc94199044edd786be434c580cad501410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342afffffffff16c04914c5bdcb3daded443d930607af535be5651c90d101f45e2edda8ae0900020000008a4730440220b39dc18dd79625518f0f6d45c453ce09cea6440bf0ea62b92df32300462709ec0220993e26e1685cea6a3c54ecc27ddd9a426988eedcecd83a1b67be5cbe07c3550501410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342afffffffff85bc216b10c008b834b4aa9f476a4dd9ec4e76393ab5d8de0c65249330cd3d32020000008a473044022061379414e7102a60c288ddbdfecb6cf265188666bfccf7cbeda69d501e3067ca0220f4e3956f1dc7c294e35994ceabf06f087e42bba6d81083e551c0fc5e8e97b0a801410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342afffffffff192ed65f7f91ae9a85e4a590fce40a3ae289633721680fd2c570b951bb80cace020000008a4730440220ea12169535d5919d54d372a29d432f5184986efcd6d48d00b2f7cd8abfbb628c0220db7fbe4e9f2d203c9d755d86054a15f572daa6f8228777446e0bd73e26b6841a01410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342afffffffff7877051e8efb33d8a11874fc741159c22f98dcfdf609ca24a6f708618b50689e010000008a4730440220a995a55e9c2f12100b0ad95c603f8967f6adeee0f1d10a87668440476074b6f0022038e3a74c5c790a412490417512c384b0b39cf49d75f8f5514bb2b56cd9bfe5b501410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342afffffffffc675f05feced0dda7021a6ab21450df11ceecb4cfa409cceca6bc4c693663d5b020000008a47304402200d005c40eef58cde2be04fca39c529bd141d230a5094a95d76a5b7aa6ae99a200220390333217a83a719ff86122a837ea7a80f2a165cb8ac86768bd283fdc06f4d3101410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342afffffffffcc08a73428971a0c8fbc0f9090492c646fd1d2aa3e2c361ec8c529b58178f793020000008a47304402206598a498ca78bc1e02b8f30efe23f163c6ba76cf7df4299c2053f0c50dc92fb80220791bc32fec52ffc4c75eb23fad97832a56035909a85adb23ac0c40209677023801410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342afffffffff95e0a8f934cfe0b4f1cf7fb4a017ae97dcfddb7c99a873d1cb8084b67d1bd741020000008a4730440220b5d6b08eda69c5992cfb78bb284cc1c98253aef06af7bd35fae22aa3c813011c0220cde72f0d6d2a7563a3b6f7ff07eb19af887681db07d4455c828ff795997b573f01410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342afffffffff111aba44b03b9572698e2a539e6ded66e302345bd1961ba36b7738c73318b395020000008a47304402204aeccdc2c44c00352dd49c21d87f2881cff16266bb3db2f2973c9b45b766a7b90220a3c398fe82074e0ac3466848f6e1cea3f2efcf6e16786086cf5f692818676b9e01410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342afffffffff35e840f5866ecf53f3f4c35f69a502ae3da4455b9582135381ce4e77970ab5c5020000008a4730440220229dcf0a53d9aaa3d8f709967fbf6a3d0912d5d795b8ffb31cf00797159501b40220f5bce5dd09693049ca7dc2f0de6a83af884c1921d7b2afc3f1bac733fe677c5301410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342afffffffff947793f112b48b3a54d91ba57fcd2b8892fd178ea2f25a234f1fdbef06a39b1a020000008a4730440220b71828d9447392e262789ec677a015dde50fbaec9b95f589bacb5f4ee3a7ef4002203f0366231575cf39a12c7b3e0340388ddc427a5cf8b24a8dc598abf819cb61db01410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342afffffffff48693382cc374573cc1dcd8a1cc311df314ec9711e42e37508e42b838c1a1324020000008a4730440220849e08b72d29cc262ec9695ce9f4fbbd87e4a71c25219129c911cb4bdc8f08430220388272b121776f0133236da4de1dbd03d211d6ddef16f9e29fa54b5dfd8bfc4b01410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342afffffffffcfdd047f8e3bf5637fdd7bb6e896c618164aaad6a8f8c3d7011bb951a16998bb020000008a47304402206d48b1764e5e8e6e3e3ea33cc2e3a526d62cdc465511f42e877278c9c3b034da0220a34421da72b83847c6e3c927b1d8dbc29f6a158052925e665aecc5737349cc0b01410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342afffffffffaaedf23be4c1ee4225b06aa5a4d4eefe16c00fee59921806bdf01dff7cdfd8fe010000008a473044022078ddddc92b2a06eb3ae1ab1482f9dfb58151e6b3a0bf4215037381f56dbfc0540220b8b15b99e40fe214dda4f32a0dc3530d453b92e031d02f1f48968d49e5e1039601410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342afffffffff0340787d0100000000c952410496ec45f878b62c46c4be8e336dff7cc58df9b502178cc240eb3d31b1266f69f5767071aa3e017d1b82a0bb28dab5e27d4d8e9725b3e68ed5f8a2d45c730621e34104cc71eb30d653c0c3163990c47b976f3fb3f37cccdcbedb169a1dfef58bbfbfaff7d8a473e7e2e6d317b87bafe8bde97e3cf8f065dec022b51d11fcdd0d348ac4410461cbdcc5409fb4b4d42b51d33381354d80e550078cb532a34bfa2fcfdeb7d76519aecc62770f5b0e4ef8551946d8a540911abe3e7854a26f39f58b25c15342af53aea0860100000000001976a914938d4cb228b4b3fb294760a7f2bcdfee8bda7b2a88ac404b4c00000000001976a914641ad5051edd97029a003fe9efb29359fcee409d88ac00000000"
    txId="14237b92d26850730ffab1bfb138121e487ddde444734ef195eb7928102bc939"
    txTitle="Example 2-of-3 Multisig Transaction"
    highlightIndex={{ outputs: 0 }}
/>

### 2. Unlocking (ScriptSig)

To spend bitcoin from a P2MS ScriptPubKey, the spenders must provide the required number of valid signatures.

For a 2-of-3 multisig, the unlocking script look like this

<CodeSnippet
    code={` 
OP_0
<Signature1>
<Signature2>
  `}
    language="javascript"
    showLineNumbers={true}
/>

Click on **Input 1** of the transaction to view the ScriptSig created to unlock the multisig output we gave before

<TransactionsDisplay
    rawTx="010000000139c92b102879eb95f14e7344e4dd7d481e1238b1bfb1fa0f735068d2927b231400000000910047304402208fc06d216ebb4b6a3a3e0f906e1512c372fa8a9c2a92505d04e9b451ea7acd0c0220764303bb7e514ddd77855949d941c934e9cbda8e3c3827bfdb5777477e73885b014730440220569ec6d2e81625dd18c73920e0079cdb4c1d67d3d7616759eb0c18cf566b3d3402201c60318f0a62e3ba85ca0f158d4dfe63c0779269eb6765b6fc939fc51e7a8ea901ffffffff0140787d01000000001976a914641ad5051edd97029a003fe9efb29359fcee409d88ac00000000"
    txId="10c61e258e0a2b19b245a96a2d0a1538fe81cd4ecd547e0a3df7ed6fd3761ada"
    txTitle="Unlocking a 2-of-3 Multisig Output"
    highlightIndex={{ inputs: 0 }}
/>

<ExpandableAlert
    title="Why is OP_0 Used in ScriptSig ?"
    type="important"
    expandable={false}
>
    OP_0 is used as a dummy value in scriptSig to address the "off-by-one" bug
    in the OP_CHECKMULTISIG opcode, which mistakenly removes an additional item
    from the stack. By inserting OP_0 at the start as a placeholder we prevent
    this bug from affecting signature verification.
</ExpandableAlert>

<ExpandableAlert
    title="Order of Signatures in P2MS"
    type="warning"
    expandable={true}
    initialLines={2}
>
    Providing signatures in the correct order is highly recommended for
    efficiency. If signatures are out of order, the script will still validate,
    but it may require more computational steps, which will slow down the
    verification process.
    <img
        src="/bitcoin-topics/static/images/topics/overview/p2ms/p2ms_order_signature.png"
        alt="P2MS Signature Order Efficiency"
    />
    Both sequences are valid in a this 1-of-3 multisig. The left sequence is
    more efficient as it matches the first public key immediately. The right
    sequence is less efficient but still valid, requiring checks against all
    three public keys before finding a match. For an M-of-N multisig: - **Best
    case:** Signatures match public keys in order - **Worst case:** Signatures
    match the last **N-M+1** public keys or don't match at all
</ExpandableAlert>

---
